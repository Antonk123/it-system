FROM node:20-alpine

WORKDIR /app

# Kopiera package.json och installera dependencies
COPY server/package*.json ./
RUN npm install

# Kopiera hela server-katalogen
COPY server/ .

# Skapa nödvändiga kataloger
RUN mkdir -p /app/data/uploads

# Exponera port
EXPOSE 3001

# Kör direkt med tsx (ingen kompilering behövs)
CMD ["npx", "tsx", "src/index.ts"]
